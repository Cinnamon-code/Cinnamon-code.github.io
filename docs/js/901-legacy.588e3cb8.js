"use strict";(self["webpackChunkcinnamon"]=self["webpackChunkcinnamon"]||[]).push([[901],{2901:function(t,e,n){n.r(e),n.d(e,{default:function(){return z}});var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post"},[n("el-row",{attrs:{gutter:30}},[n("el-col",{attrs:{xs:24,sm:16,lg:18,xl:18}},[n("div",{staticClass:"editor"},[n("h1",[t._v("开始你的创作吧！")]),n("editor",{ref:"editor",attrs:{"api-key":t.apiKey,init:t.init,"cloud-channel":"6","tag-name":"div"},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)]),n("el-col",{attrs:{xs:24,sm:8,lg:6,xl:6}},[n("div",{staticClass:"title"},[n("h1",[t._v("好听的标题")]),n("el-input",{model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),n("div",{staticClass:"digest"},[n("h1",[t._v("内容摘要")]),n("el-input",{attrs:{type:"textarea",rows:12},model:{value:t.digest,callback:function(e){t.digest=e},expression:"digest"}})],1)])],1),n("div",{staticClass:"select-cover"},[n("h1",[t._v("选个封面")]),n("s-image-upload",{on:{change:t.handleChange}})],1),n("el-button",{staticClass:"submit-btn",attrs:{type:"primary",plain:"",loading:t.loading},on:{click:t.submit}},[t._v(t._s(t.btnText))])],1)},o=[],r=n(655),s=n(144),a=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],l=function(t){return-1!==a.map((function(t){return t.toLowerCase()})).indexOf(t.toLowerCase())},c=function(t,e,n){Object.keys(e).filter(l).forEach((function(i){var o=e[i];"function"===typeof o&&("onInit"===i?o(t,n):n.on(i.substring(2),(function(t){return o(t,n)})))}))},u=function(t,e){var n=t.$props.modelEvents?t.$props.modelEvents:null,i=Array.isArray(n)?n.join(" "):n;e.on(i||"change input undo redo",(function(){t.$emit("input",e.getContent({format:t.$props.outputFormat}))}))},d=function(t,e,n){var i=e.$props.value?e.$props.value:"",o=e.$props.initialValue?e.$props.initialValue:"";n.setContent(i||(e.initialized?e.cache:o)),e.$watch("value",(function(t,i){n&&"string"===typeof t&&t!==i&&t!==n.getContent({format:e.$props.outputFormat})&&n.setContent(t)})),e.$listeners.input&&u(e,n),c(t,e.$listeners,n),e.initialized=!0},p=0,h=function(t){var e=Date.now(),n=Math.floor(1e9*Math.random());return p++,t+"_"+n+p+String(e)},f=function(t){return null!==t&&"textarea"===t.tagName.toLowerCase()},m=function(t){return"undefined"===typeof t||""===t?[]:Array.isArray(t)?t:t.split(" ")},g=function(t,e){return m(t).concat(m(e))},v=function(t){return null===t||void 0===t},y=function(){return{listeners:[],scriptId:h("tiny-script"),scriptLoaded:!1}},b=function(){var t=y(),e=function(t,e,n,i){var o=e.createElement("script");o.referrerPolicy="origin",o.type="application/javascript",o.id=t,o.src=n;var r=function(){o.removeEventListener("load",r),i()};o.addEventListener("load",r),e.head&&e.head.appendChild(o)},n=function(n,i,o){t.scriptLoaded?o():(t.listeners.push(o),n.getElementById(t.scriptId)||e(t.scriptId,n,i,(function(){t.listeners.forEach((function(t){return t()})),t.scriptLoaded=!0})))},i=function(){t=y()};return{load:n,reinitialize:i}},C=b(),$=function(){return"undefined"!==typeof window?window:n.g},S=function(){var t=$();return t&&t.tinymce?t.tinymce:null},w={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],value:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(t){return"html"===t||"text"===t}}},x=function(){return x=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},x.apply(this,arguments)},k=function(t,e,n){return t(n||"div",{attrs:{id:e}})},E=function(t,e){return t("textarea",{attrs:{id:e},style:{visibility:"hidden"}})},D=function(t){return function(){var e=x(x({},t.$props.init),{readonly:t.$props.disabled,selector:"#"+t.elementId,plugins:g(t.$props.init&&t.$props.init.plugins,t.$props.plugins),toolbar:t.$props.toolbar||t.$props.init&&t.$props.init.toolbar,inline:t.inlineEditor,setup:function(e){t.editor=e,e.on("init",(function(n){return d(n,t,e)})),t.$props.init&&"function"===typeof t.$props.init.setup&&t.$props.init.setup(e)}});f(t.element)&&(t.element.style.visibility="",t.element.style.display=""),S().init(e)}},I={props:w,created:function(){this.elementId=this.$props.id||h("tiny-vue"),this.inlineEditor=this.$props.init&&this.$props.init.inline||this.$props.inline,this.initialized=!1},watch:{disabled:function(){this.editor.setMode(this.disabled?"readonly":"design")}},mounted:function(){if(this.element=this.$el,null!==S())D(this)();else if(this.element&&this.element.ownerDocument){var t=this.$props.cloudChannel?this.$props.cloudChannel:"5",e=this.$props.apiKey?this.$props.apiKey:"no-api-key",n=v(this.$props.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+e+"/tinymce/"+t+"/tinymce.min.js":this.$props.tinymceScriptSrc;C.load(this.element.ownerDocument,n,D(this))}},beforeDestroy:function(){null!==S()&&S().remove(this.editor)},deactivated:function(){var t;this.inlineEditor||(this.cache=this.editor.getContent(),null===(t=S())||void 0===t||t.remove(this.editor))},activated:function(){!this.inlineEditor&&this.initialized&&D(this)()},render:function(t){return this.inlineEditor?k(t,this.elementId,this.$props.tagName):E(t,this.elementId)}},A=I,_={API_KEY:"e34ndt5d8ui8r311yzt7tgx9xdo7q6mm2dib76x5cxucshwg",plugins:["advlist","autolink","lists","link","image","charmap","preview","anchor","searchreplace","visualblocks","fullscreen","insertdatetime","media","table","help","wordcount"],toolbar:"undo redo | formatpainter casechange blocks | bold italic backcolor |\n            alignleft aligncenter alignright alignjustify |\n            bullist numlist checklist outdent indent | removeformat | a11ycheck code table help",skin:"oxide-dark"},P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"s-image-upload",on:{click:t.handleClick}},[n("div",{staticClass:"s-image-upload__inner",style:{height:t.height+"px"}},[t.imageUrl?n("img",{attrs:{src:t.imageUrl}}):n("i",{staticClass:"el-icon-plus upload-icon",style:{lineHeight:t.height+"px"}})]),n("input",{ref:"input",attrs:{type:"file",hidden:"",name:t.name},on:{change:t.handleChange}})])},U=[],O=s["default"].extend({name:"SImageUpload",data:function(){return{imageUrl:""}},props:{name:{type:String,default:function(){return"file"}},height:{type:Number,default:function(){return 500}}},methods:{handleClick:function(){this.$refs.input.click()},read:function(t){var e=this;if(t){var n=new FileReader;n.readAsDataURL(t),n.onload=function(){e.imageUrl=n.result}}},handleChange:function(t){var e=t.target.files,n=e?e[0]:null;this.read(n);var i=new FormData;i.set("cover",n),this.$emit("change",i)}}}),M=O,j=n(1001),L=(0,j.Z)(M,P,U,!1,null,"5f72f666",null),B=L.exports,K=s["default"].extend({name:"PostView",data:function(){return{apiKey:_.API_KEY,init:(0,r.pi)({height:800,borderRadius:0},_),title:"",content:"",digest:"",cover:new FormData,loading:!1,btnText:"提交"}},methods:{handleChange:function(t){this.cover=t},submit:function(){var t,e,n;return(0,r.mG)(this,void 0,void 0,(function(){var i=this;return(0,r.Jh)(this,(function(o){switch(o.label){case 0:return this.loading=!0,null===(t=this.cover)||void 0===t||t.set("title",this.title),null===(e=this.cover)||void 0===e||e.set("digest",this.digest),null===(n=this.cover)||void 0===n||n.set("content",this.content),[4,this.$http.post({url:"/post/upload",data:this.cover}).then((function(t){var e=t.data;i.loading=!1,i.$message({type:e.status?"success":"error",message:e.msg,duration:1500,onClose:function(){e.status&&location.reload()}})})).catch((function(t){i.loading=!1,i.$message({type:"error",message:t.message,duration:1500})}))];case 1:return o.sent(),[2]}}))}))}},components:{SImageUpload:B,Editor:A}}),R=K,F=(0,j.Z)(R,i,o,!1,null,null,null),z=F.exports}}]);
//# sourceMappingURL=901-legacy.588e3cb8.js.map